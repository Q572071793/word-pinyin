name: ğŸ§ª è‡ªåŠ¨æµ‹è¯•

on:
  push:
    branches: [ main, master, develop ]
  pull_request:
    branches: [ main, master, develop ]

jobs:
  test:
    name: è¿è¡Œæµ‹è¯•
    runs-on: ${{ matrix.os }}
    
    strategy:
      matrix:
        os: [ubuntu-latest, windows-latest, macos-latest]
        node-version: [14.x, 16.x, 18.x]
    
    steps:
    - name: ğŸ“¥ æ£€å‡ºä»£ç 
      uses: actions/checkout@v3
    
    - name: ğŸ”§ è®¾ç½®Node.js ${{ matrix.node-version }}
      uses: actions/setup-node@v3
      with:
        node-version: ${{ matrix.node-version }}
        cache: 'npm'
    
    - name: ğŸ“¦ å®‰è£…ä¾èµ–
      run: npm ci
    
    - name: ğŸ” è¿è¡Œæµ‹è¯•
      run: npm test
    
    - name: ğŸ“Š ä¸Šä¼ æµ‹è¯•æŠ¥å‘Š
      if: failure()
      uses: actions/upload-artifact@v3
      with:
        name: test-results-${{ matrix.os }}-node${{ matrix.node-version }}
        path: test-results/
        retention-days: 30